{"pageProps":{"toc":[{"url":"#","text":"Overview","depth":2},{"url":"#文本替换","depth":3,"text":"文本替换"},{"url":"#修改结果","depth":3,"text":"修改结果"}],"content":"[\"$r\",null,null,{\"children\":[[\"$r\",\"p\",null,{\"children\":\"该文件夹只提供 CentOS Stream 9，非 Stream 版的 CentOS 已经停止支持。\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"CentOS Stream 9 默认启用了包管理工具 dnf，其是 yum 包管理工具的替代品。dnf 与 yum 大部分的命令都是通用的，dnf 也使用 \",[\"$r\",\"code\",null,{\"children\":\"/etc/yum.repos.d/\"}],\" 进行镜像配置。\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"CentOS Stream 9 中源被整合入两个文件 \",[\"$r\",\"code\",null,{\"children\":\"centos.repo\"}],\" 和 \",[\"$r\",\"code\",null,{\"children\":\"centos-addons.repo\"}],\"，由于文件中不包含 \",[\"$r\",\"code\",null,{\"children\":\"baseurl\"}],\" 字段，需要手动插入，通过文本替换修改源的方法较为复杂，也可以选择直接复制最后的替换结果覆盖源文件。\"]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"文本替换\",\"children\":\"文本替换\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"将这段代码保存为一个文件，例如 \",[\"$r\",\"code\",null,{\"children\":\"update_mirror.pl\"}],\"。\"]}],\"\\n\",[\"$r\",\"CodeBlock\",null,{\"enableQuickSetup\":true,\"filepath\":\"/tmp/update_mirror.pl\",\"code\":\"#!/usr/bin/perl\\n\\nuse strict;\\nuse warnings;\\nuse autodie;\\n\\nmy $mirrors = '{{http_protocol}}{{mirror}}';\\n\\nif (@ARGV < 1) {\\n    die \\\"Usage: $0 <filename1> <filename2> ...\\\\n\\\";\\n}\\n\\nwhile (my $filename = shift @ARGV) {\\n    my $backup_filename = $filename . '.bak';\\n    rename $filename, $backup_filename;\\n\\n    open my $input, \\\"<\\\", $backup_filename;\\n    open my $output, \\\">\\\", $filename;\\n\\n    while (<$input>) {\\n        s/^metalink/# metalink/;\\n\\n        if (m/^name/) {\\n            my (undef, $repo, $arch) = split /-/;\\n            $repo =~ s/^\\\\s+|\\\\s+$//g;\\n            ($arch = defined $arch ? lc($arch) : '') =~ s/^\\\\s+|\\\\s+$//g;\\n\\n            if ($repo =~ /^Extras/) {\\n                $_ .= \\\"baseurl=${mirrors}/SIGs/\\\\$releasever-stream/extras\\\" . ($arch eq 'source' ? \\\"/${arch}/\\\" : \\\"/\\\\$basearch/\\\") . \\\"extras-common\\\\n\\\";\\n            } else {\\n                $_ .= \\\"baseurl=${mirrors}/\\\\$releasever-stream/$repo\\\" . ($arch eq 'source' ? \\\"/\\\" : \\\"/\\\\$basearch/\\\") . ($arch ne '' ? \\\"${arch}/tree/\\\" : \\\"os\\\") . \\\"\\\\n\\\";\\n            }\\n        }\\n\\n        print $output $_;\\n    }\\n}\",\"codeLanguage\":\"perl\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"然后，在命令行中使用以下命令来执行它：\"}],\"\\n\",[\"$r\",\"CodeBlock\",null,{\"code\":\"{{sudo}}perl /tmp/update_mirror.pl /etc/yum.repos.d/centos*.repo\",\"codeLanguage\":\"shell\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"注意将 \",[\"$r\",\"code\",null,{\"children\":\"/tmp/update_mirror.pl\"}],\" 替换为脚本实际保存的路径。其中的 \",[\"$r\",\"code\",null,{\"children\":\"*\"}],\" 通配符，如果只需要替换一些文件中的源，请自行增删。\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"另外，请确保已经安装了 Perl 解释器，并将 \",[\"$r\",\"code\",null,{\"children\":\"perl\"}],\" 命令添加到系统的 \",[\"$r\",\"code\",null,{\"children\":\"PATH\"}],\" 环境变量中。这样才能在命令行中运行 Perl 脚本。\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"对于大部分 CentOS Stream 9 镜像，应该已经包含了 Perl 解释器，如果你的镜像没有包含，你可以使用以下命令简单的安装：\"}],\"\\n\",[\"$r\",\"CodeBlock\",null,{\"code\":\"# 使用 dnf\\n{{sudo}}dnf install perl\\n\\n# 使用 yum\\n{{sudo}}yum install perl\",\"codeLanguage\":\"shell\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"最后，更新软件包缓存\"}],\"\\n\",[\"$r\",\"CodeBlock\",null,{\"code\":\"# 使用 dnf\\n{{sudo}}dnf clean all && {{sudo}}dnf makecache\\n\\n# 使用 yum\\n{{sudo}}yum clean all && {{sudo}}yum makecache\",\"codeLanguage\":\"shell\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"注意，如果需要启用其中一些 repo，需要将其中的 \",[\"$r\",\"code\",null,{\"children\":\"enabled=0\"}],\" 改为 \",[\"$r\",\"code\",null,{\"children\":\"enabled=1\"}],\"。\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"$r\",\"strong\",null,{\"children\":\"注：截至 2023-05-16，并未在官方源与镜像源中发现 nfv-source，建议不要开启 nfv-source。\"}]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"修改结果\",\"children\":\"修改结果\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"你可以对照替换结果是否准确，或直接复制结果覆盖源文件。\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"centos.repo\"}],\":\"]}],\"\\n\",[\"$r\",\"CodeBlock\",null,{\"enableQuickSetup\":true,\"filepath\":\"/etc/yum.repos.d/centos.repo\",\"code\":\"[baseos]\\nname=CentOS Stream $releasever - BaseOS\\nbaseurl={{http_protocol}}{{mirror}}/$releasever-stream/BaseOS/$basearch/os\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-baseos-$stream&arch=$basearch&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\ncountme=1\\nenabled=1\\n\\n[baseos-debuginfo]\\nname=CentOS Stream $releasever - BaseOS - Debug\\nbaseurl={{http_protocol}}{{mirror}}/$releasever-stream/BaseOS/$basearch/debug/tree/\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-baseos-debug-$stream&arch=$basearch&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\nenabled=0\\n\\n[baseos-source]\\nname=CentOS Stream $releasever - BaseOS - Source\\nbaseurl={{http_protocol}}{{mirror}}/$releasever-stream/BaseOS/source/tree/\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-baseos-source-$stream&arch=source&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\nenabled=0\\n\\n[appstream]\\nname=CentOS Stream $releasever - AppStream\\nbaseurl={{http_protocol}}{{mirror}}/$releasever-stream/AppStream/$basearch/os\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-appstream-$stream&arch=$basearch&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\ncountme=1\\nenabled=1\\n\\n[appstream-debuginfo]\\nname=CentOS Stream $releasever - AppStream - Debug\\nbaseurl={{http_protocol}}{{mirror}}/$releasever-stream/AppStream/$basearch/debug/tree/\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-appstream-debug-$stream&arch=$basearch&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\nenabled=0\\n\\n[appstream-source]\\nname=CentOS Stream $releasever - AppStream - Source\\nbaseurl={{http_protocol}}{{mirror}}/$releasever-stream/AppStream/source/tree/\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-appstream-source-$stream&arch=source&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\nenabled=0\\n\\n[crb]\\nname=CentOS Stream $releasever - CRB\\nbaseurl={{http_protocol}}{{mirror}}/$releasever-stream/CRB/$basearch/os\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-crb-$stream&arch=$basearch&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\ncountme=1\\nenabled=1\\n\\n[crb-debuginfo]\\nname=CentOS Stream $releasever - CRB - Debug\\nbaseurl={{http_protocol}}{{mirror}}/$releasever-stream/CRB/$basearch/debug/tree/\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-crb-debug-$stream&arch=$basearch&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\nenabled=0\\n\\n[crb-source]\\nname=CentOS Stream $releasever - CRB - Source\\nbaseurl={{http_protocol}}{{mirror}}/$releasever-stream/CRB/source/tree/\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-crb-source-$stream&arch=source&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\nenabled=0\",\"codeLanguage\":\"ini\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"centos-addons.repo\"}],\":\"]}],\"\\n\",[\"$r\",\"CodeBlock\",null,{\"enableQuickSetup\":true,\"filepath\":\"/etc/yum.repos.d/centos-addons.repo\",\"code\":\"[highavailability]\\nname=CentOS Stream $releasever - HighAvailability\\nbaseurl={{http_protocol}}{{mirror}}/$releasever-stream/HighAvailability/$basearch/os\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-highavailability-$stream&arch=$basearch&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\ncountme=1\\nenabled=0\\n\\n[highavailability-debuginfo]\\nname=CentOS Stream $releasever - HighAvailability - Debug\\nbaseurl={{http_protocol}}{{mirror}}/$releasever-stream/HighAvailability/$basearch/debug/tree/\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-highavailability-debug-$stream&arch=$basearch&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\nenabled=0\\n\\n[highavailability-source]\\nname=CentOS Stream $releasever - HighAvailability - Source\\nbaseurl={{http_protocol}}{{mirror}}/$releasever-stream/HighAvailability/source/tree/\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-highavailability-source-$stream&arch=source&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\nenabled=0\\n\\n[nfv]\\nname=CentOS Stream $releasever - NFV\\nbaseurl={{http_protocol}}{{mirror}}/$releasever-stream/NFV/$basearch/os\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-nfv-$stream&arch=$basearch&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\ncountme=1\\nenabled=0\\n\\n[nfv-debuginfo]\\nname=CentOS Stream $releasever - NFV - Debug\\nbaseurl={{http_protocol}}{{mirror}}/$releasever-stream/NFV/$basearch/debug/tree/\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-nfv-debug-$stream&arch=$basearch&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\nenabled=0\\n\\n[nfv-source]\\nname=CentOS Stream $releasever - NFV - Source\\nbaseurl={{http_protocol}}{{mirror}}/$releasever-stream/NFV/source/tree/\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-nfv-source-$stream&arch=source&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\nenabled=0\\n\\n[rt]\\nname=CentOS Stream $releasever - RT\\nbaseurl={{http_protocol}}{{mirror}}/$releasever-stream/RT/$basearch/os\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-rt-$stream&arch=$basearch&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\ncountme=1\\nenabled=0\\n\\n[rt-debuginfo]\\nname=CentOS Stream $releasever - RT - Debug\\nbaseurl={{http_protocol}}{{mirror}}/$releasever-stream/RT/$basearch/debug/tree/\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-rt-debug-$stream&arch=$basearch&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\nenabled=0\\n\\n[rt-source]\\nname=CentOS Stream $releasever - RT - Source\\nbaseurl={{http_protocol}}{{mirror}}/$releasever-stream/RT/source/tree/\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-rt-source-$stream&arch=source&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\nenabled=0\\n\\n[resilientstorage]\\nname=CentOS Stream $releasever - ResilientStorage\\nbaseurl={{http_protocol}}{{mirror}}/$releasever-stream/ResilientStorage/$basearch/os\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-resilientstorage-$stream&arch=$basearch&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\ncountme=1\\nenabled=0\\n\\n[resilientstorage-debuginfo]\\nname=CentOS Stream $releasever - ResilientStorage - Debug\\nbaseurl={{http_protocol}}{{mirror}}/$releasever-stream/ResilientStorage/$basearch/debug/tree/\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-resilientstorage-debug-$stream&arch=$basearch&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\nenabled=0\\n\\n[resilientstorage-source]\\nname=CentOS Stream $releasever - ResilientStorage - Source\\nbaseurl={{http_protocol}}{{mirror}}/$releasever-stream/ResilientStorage/source/tree/\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-resilientstorage-source-$stream&arch=source&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\nenabled=0\\n\\n[extras-common]\\nname=CentOS Stream $releasever - Extras packages\\nbaseurl={{http_protocol}}{{mirror}}/SIGs/$releasever-stream/extras/$basearch/extras-common\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-extras-sig-extras-common-$stream&arch=$basearch&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-SIG-Extras-SHA512\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\ncountme=1\\nenabled=1\\n\\n[extras-common-source]\\nname=CentOS Stream $releasever - Extras packages - Source\\nbaseurl={{http_protocol}}{{mirror}}/SIGs/$releasever-stream/extras/source/extras-common\\n# metalink=https://mirrors.centos.org/metalink?repo=centos-extras-sig-extras-common-source-$stream&arch=source&protocol=https,http\\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-SIG-Extras-SHA512\\ngpgcheck=1\\nrepo_gpgcheck=0\\nmetadata_expire=6h\\nenabled=0\",\"codeLanguage\":\"ini\"}]]}]","meta":{"title":"CentOS Stream 软件仓库镜像使用帮助","cname":"centos-stream"},"cname":"centos-stream"},"__N_SSG":true}