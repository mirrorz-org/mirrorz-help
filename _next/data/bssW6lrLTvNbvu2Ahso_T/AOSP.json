{"pageProps":{"toc":[{"url":"#","text":"Overview","depth":2},{"url":"#过程摘录","depth":2,"text":"过程摘录"},{"url":"#下载-repo-工具","depth":3,"text":"下载 repo 工具"},{"url":"#使用每月更新的初始化包","depth":3,"text":"使用每月更新的初始化包"},{"url":"#传统初始化方法","depth":3,"text":"传统初始化方法"},{"url":"#建立次级镜像","depth":3,"text":"建立次级镜像"},{"url":"#替换已有的-aosp-源代码的-remote","depth":3,"text":"替换已有的 AOSP 源代码的 remote"},{"url":"#说明","depth":3,"text":"说明"},{"url":"#brillo","depth":3,"text":"Brillo"},{"url":"#lineageos-中对于-aosp-的替换","depth":2,"text":"LineageOS 中对于 AOSP 的替换"}],"content":"[\"$r\",null,null,{\"children\":[[\"$r\",\"p\",null,{\"children\":[\"$r\",\"strong\",null,{\"children\":\"注意：本镜像是 AOSP 镜像，Android SDK 因版权原因，我们不能提供镜像服务。\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"$r\",\"strong\",null,{\"children\":[\"可访问 \",[\"$r\",\"a\",null,{\"href\":\"https://cs.android.com\",\"rel\":\"nofollow\",\"children\":\"https://cs.android.com\"}],\" 或 \",[\"$r\",\"a\",null,{\"href\":\"https://github.com/aosp-mirror\",\"rel\":\"nofollow\",\"children\":\"https://github.com/aosp-mirror\"}],\" 在线搜索及浏览 AOSP 源码。\"]}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"参考 Google 教程 \",[\"$r\",\"a\",null,{\"href\":\"https://source.android.com/setup/build/downloading\",\"rel\":\"nofollow\",\"children\":\"https://source.android.com/setup/build/downloading\"}],\"，\\n将 \",[\"$r\",\"code\",null,{\"children\":\"https://android.googlesource.com/\"}],\" 全部使用如下链接代替即可。\"]}],\"\\n\",[\"$r\",\"CodeBlock\",null,{\"code\":\"{{http_protocol}}{{mirror}}/\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"由于使用 HTTPS 协议更安全，并且更便于我们灵活处理，所以强烈推荐使用 HTTPS 协议同步 AOSP 镜像。\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"$r\",\"strong\",null,{\"children\":\"由于 AOSP 镜像造成 CPU/内存负载过重，我们限制了并发数量，因此建议：\"}]}],\"\\n\",[\"$r\",\"ol\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"sync 的时候并发数不宜太高，否则会出现 503 错误，即 \",[\"$r\",\"code\",null,{\"children\":\"-j\"}],\" 后面的数字不能太大，建议选择 4。\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"请尽量选择流量较小时错峰同步。\"}],\"\\n\"]}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"过程摘录\",\"children\":\"过程摘录\"}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"下载-repo-工具\",\"children\":\"下载 repo 工具\"}],\"\\n\",[\"$r\",\"SyntaxHighlight\",null,{\"code\":\"mkdir ~/bin\\nPATH=~/bin:$PATH\\ncurl https://storage.googleapis.com/git-repo-downloads/repo > ~/bin/repo\\nchmod a+x ~/bin/repo\",\"language\":\"bash\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"或者使用 \",[\"$r\",\"a\",null,{\"href\":\"/git-repo/\",\"children\":\"git-repo 镜像\"}]]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"使用每月更新的初始化包\",\"children\":\"使用每月更新的初始化包\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"参考 \",[\"$r\",\"a\",null,{\"href\":\"/aosp-monthly/\",\"children\":\"AOSP Monthly 镜像\"}]]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"传统初始化方法\",\"children\":\"传统初始化方法\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"建立工作目录：\"}],\"\\n\",[\"$r\",\"SyntaxHighlight\",null,{\"code\":\"mkdir WORKING_DIRECTORY\\ncd WORKING_DIRECTORY\",\"language\":\"bash\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"初始化仓库：\"}],\"\\n\",[\"$r\",\"CodeBlock\",null,{\"code\":\"repo init -u {{http_protocol}}{{mirror}}/platform/manifest\",\"codeLanguage\":\"bash\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"$r\",\"strong\",null,{\"children\":[\"如果提示无法连接到 gerrit.googlesource.com，请参照 \",[\"$r\",\"a\",null,{\"href\":\"/git-repo/\",\"children\":\"git-repo 的帮助页面\"}],\"的更新一节。\"]}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"如果需要某个特定的 Android 版本 (见「说明」中「Android 版本列表」部分)：\"}],\"\\n\",[\"$r\",\"CodeBlock\",null,{\"code\":\"repo init -u {{http_protocol}}{{mirror}}/platform/manifest -b android-4.0.1_r1\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"同步源码树（以后只需执行这条命令来同步）：\"}],\"\\n\",[\"$r\",\"SyntaxHighlight\",null,{\"code\":\"repo sync\"}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"建立次级镜像\",\"children\":\"建立次级镜像\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"由于 AOSP 镜像需求量巨大，且 Git 服务占资源较多，部分镜像站服务器因 AOSP 产生的负载已经占主要部分。\\n如果你是团队用户，我们强烈建议你建立次级镜像，再分享给团队内其他用户，减轻服务器压力。\\n建立 AOSP 镜像需要占用约 850G 磁盘。\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"具体步骤为：\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"下载 \",[\"$r\",\"code\",null,{\"children\":\"repo\"}],\" 工具和建立工作目录（略）\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"初始化：\"}],\"\\n\",[\"$r\",\"CodeBlock\",null,{\"code\":\"repo init -u {{http_protocol}}{{mirror}}/mirror/manifest --mirror\",\"codeLanguage\":\"bash\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"最后同步源码树：\"}],\"\\n\",[\"$r\",\"SyntaxHighlight\",null,{\"code\":\"repo sync\",\"language\":\"bash\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"同步完成后，运行 \",[\"$r\",\"code\",null,{\"children\":\"git daemon --verbose --export-all  --base-path=WORKING_DIR WORKING_DIR\"}],\" (\",[\"$r\",\"code\",null,{\"children\":\"WORKING_DIR\"}],\"为代码树所在目录) 。\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"此后，其他用户使用 \",[\"$r\",\"code\",null,{\"children\":\"git://ip.to.mirror/\"}],\" 作为镜像即可。\"]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"替换已有的-aosp-源代码的-remote\",\"children\":\"替换已有的 AOSP 源代码的 remote\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"如果你之前已经通过某种途径获得了 AOSP 的源码 (或者你只是 init 这一步完成后)，\\n你希望以后通过 TUNA 同步 AOSP 部分的代码，只需要修改 \",[\"$r\",\"code\",null,{\"children\":\".repo/manifests.git/config\"}],\"，将\"]}],\"\\n\",[\"$r\",\"SyntaxHighlight\",null,{\"code\":\"url = https://android.googlesource.com/platform/manifest\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"更改为\"}],\"\\n\",[\"$r\",\"CodeBlock\",null,{\"code\":\"url = {{http_protocol}}{{mirror}}/platform/manifest\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"或者可以不修改文件，而执行\"}],\"\\n\",[\"$r\",\"CodeBlock\",null,{\"code\":\"git config --global url.{{http_protocol}}{{mirror}}/.insteadof https://android.googlesource.com\"}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"说明\",\"children\":\"说明\"}],\"\\n\",[\"$r\",\"h4\",null,{\"id\":\"通用\",\"children\":\"通用\"}],\"\\n\",[\"$r\",\"ol\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":\"镜像的是什么？\"}],\"\\n\",[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":\"AOSP 的 git 仓库\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"Android 版本列表：\",[\"$r\",\"a\",null,{\"href\":\"https://source.android.com/source/build-numbers.html#source-code-tags-and-builds\",\"rel\":\"nofollow\",\"children\":\"https://source.android.com/source/build-numbers.html#source-code-tags-and-builds\"}],\" 或 \",[\"$r\",\"a\",null,{\"href\":\"https://source.android.google.cn/source/build-numbers#source-code-tags-and-builds\",\"rel\":\"nofollow\",\"children\":\"https://source.android.google.cn/source/build-numbers#source-code-tags-and-builds\"}]]}],\"\\n\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":\"镜像站 tags 列表（部分镜像站可浏览）\"}],\"\\n\",[\"$r\",\"CodeBlock\",null,{\"code\":\"{{http_protocol}}{{mirror}}/platform/manifest.git/refs/tags/\"}],\"\\n\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"出现 \",[\"$r\",\"code\",null,{\"children\":\"curl: (22) The requested URL returned error: 404 Not Found Server does not provide clone.bundle; ignoring.\"}],\" 怎么办？\"]}],\"\\n\",[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":\"无视即可。\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"参见：\",[\"$r\",\"a\",null,{\"href\":\"https://github.com/tuna/issues/issues/936\",\"rel\":\"nofollow\",\"children\":\"https://github.com/tuna/issues/issues/936\"}]]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$r\",\"h4\",null,{\"id\":\"tunabfsu\",\"children\":\"TUNA/BFSU\"}],\"\\n\",[\"$r\",\"ol\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"为何不能通过浏览器访问？\",\"\\n\",[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":\"暂时没有 gitweb, 而且反正是 git bare 仓库，没有可以直接看到的内容。\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"建议访问 \",[\"$r\",\"a\",null,{\"href\":\"https://cs.android.com\",\"rel\":\"nofollow\",\"children\":\"https://cs.android.com\"}],\" 或 \",[\"$r\",\"a\",null,{\"href\":\"https://github.com/aosp-mirror\",\"rel\":\"nofollow\",\"children\":\"https://github.com/aosp-mirror\"}],\" 在线搜索及浏览 AOSP 源码。\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$r\",\"h4\",null,{\"id\":\"ustc\",\"children\":\"USTC\"}],\"\\n\",[\"$r\",\"ol\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"由于硬盘 I/O 资源有限，Git 服务器每 IP 限制 5 个并发连接。\\n\",[\"$r\",\"code\",null,{\"children\":\"repo sync\"}],\" 命令默认使用 4 个并发连接，请勿使用 \",[\"$r\",\"code\",null,{\"children\":\"-j\"}],\"\\n参数增加并发连接数。\"]}],\"\\n\"]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"brillo\",\"children\":\"Brillo\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"Brillo 项目的代码托管在 AOSP 项目中，镜像站镜像的是整个 AOSP\\n项目，所以自然也能从本镜像下载 Brillo 项目代码。\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"参考 Brillo 官方文档\\n\",[\"$r\",\"a\",null,{\"href\":\"https://developers.google.com/brillo/docs/reference/downloads\",\"rel\":\"nofollow\",\"children\":\"https://developers.google.com/brillo/docs/reference/downloads\"}],\"\\n进行下载，将其中源码 manifest 地址 改为\"]}],\"\\n\",[\"$r\",\"CodeBlock\",null,{\"code\":\"{{http_protocol}}{{mirror}}/brillo/manifest\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"即 \",[\"$r\",\"code\",null,{\"children\":\"repo init\"}],\" 时，使用\"]}],\"\\n\",[\"$r\",\"CodeBlock\",null,{\"code\":\"repo init -u {{http_protocol}}{{mirror}}/brillo/manifest -b master\"}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"lineageos-中对于-aosp-的替换\",\"children\":\"LineageOS 中对于 AOSP 的替换\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"打开\",[\"$r\",\"code\",null,{\"children\":\".repo/manifests/default.xml\"}],\"，将\"]}],\"\\n\",[\"$r\",\"SyntaxHighlight\",null,{\"code\":\"  <remote  name=\\\"aosp\\\"\\n           fetch=\\\"https://android.googlesource.com\\\"\",\"language\":\"xml\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"改成\"}],\"\\n\",[\"$r\",\"CodeBlock\",null,{\"code\":\"  <remote  name=\\\"aosp\\\"\\n           fetch=\\\"{{http_protocol}}{{mirror}}\\\"\",\"codeLanguage\":\"xml\"}]]}]","meta":{"title":"AOSP 镜像使用帮助","cname":"AOSP"},"cname":"AOSP"},"__N_SSG":true}